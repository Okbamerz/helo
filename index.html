<!DOCTYPE html>
<html lang="en">

<head>
    <!-- meta data -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- title -->
    <title>Calculateur de Moyenne</title>
    <!-- css -->
    <link rel='stylesheet' type='text/css' media='all' href="assets/css/bootstrap.min.css" />
    <link rel='stylesheet' type='text/css' media='all' href="assets/css/shards.min.css" />
    <link rel='stylesheet' type='text/css' media='all' href="assets/css/shards-extras.min.css" />
    <link rel='stylesheet' type='text/css' media='all' href="assets/css/style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <div id="main-container">
        <div class="page-header">
            <nav class="navbar navbar-expand-lg navbar-dark">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarText">
                    <ul class="navbar-nav mr-auto"  id="navbarTextList">
                        <li class="nav-item active">

                        </li>
                       
                    </ul>
                    <span class="navbar-text">
                        <h3 id="nav-titre">Calculateur de Moyenne</h3>
                    </span>
                </div>
            </nav>
        </div>
        <!-- in case adding new modules you must stick with syntax of the id's      -->
        <!--                                                                         -->

        <!--   tdModule =============> Note de td                                -->
        <!--   tpModule =============> Note de tp                                -->
        <!--   exModule =============  >Note d'exam                              -->
        <!--   CoefModule =============> coefficient de module                   -->
        <!--   CredModule =============>crédit de module                         -->
        <!--   moModule =============> moyenne de module obtenu                  -->
        <!--   crModule =============> crédit de module obtenu                   -->
        <!--   MoynneU1/MoynneU1S2 =============> moyenne d'unité obtenu         -->
        <!--   CU1/CU_S2  =============>    crédit d'unité obtenu                -->







        <div class="page-content">
            <div class="tables-container">
                <div class="tables"  id="tables"  style="overflow-x:auto;">
                    <table id="table1" class="table-striped  mb-5">
                        <thead>
                            <tr>
                                <th id="titre1" colspan="11">
                                    <h2>Semestre 1</h2>
                                </th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>
                                    <h6>Modules</h6>
                                </th>
                                <th class="noneed">
                                    <h6>Coef</h6>
                                </th>
                                <th class="noneed">
                                    <h6>Créd</h6>
                                </th>
                                <th>
                                    <h6>Note TD</h6> |
                                    <h6>TP</h6> |
                                    <h6> Exam</h6>
                                </th>

                                <th>
                                    <h6>Moyenne Module</h6>
                                </th>
                                <th>
                                    <h6>Créd Mod</h6>
                                </th>

                            </tr>

                            <!----------------------------------------2em Semstre -------------------------------------------------->
                        </tbody>
                    </table>
                    <table id="table2" class="table-striped  ">
                        <thead>
                            <tr>
                                <th id="titre2" colspan="11">
                                    <h2>Semestre 2</h2>
                                </th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>
                                    <h6>Modules</h6>
                                </th>
                                <th class="noneed">
                                    <h6>Coef</h6>
                                </th>
                                <th class="noneed">
                                    <h6>Créd</h6>
                                </th>                                
                                <th>
                                    <h6>Note TD</h6> |
                                    <h6>TP</h6> |
                                    <h6> Exam</h6>
                                </th>

                                <th>
                                    <h6>Moyenne Module</h6>
                                </th>
                                <th>
                                    <h6>Créd Mod</h6>
                                </th>

                            </tr>

                            <!----------------------------------------2em Semstre -------------------------------------------------->
                        </tbody>
                    </table>
                </div>
            </div>
<!--
            <div style="padding-bottom:50px" class="tables-container">
-->
            <div class="tables-container">
                <div class="tables"  id="tables"  style="overflow-x:auto;">
                <table id="table3" class="table-striped">
                    <!--ligne 8-->
                    <tbody >
                       <tr>
                            <th>
                                <h5>Semestre/année</h5>
                            </th>
                            <th>
                                <h5>Moyenne</h5>
                            </th>
                            <th>
                                <h5>Crédits</h5>
                            </th>
                        </tr>
                        <tr>
                            <td>
                                <h5>Semestre 1</h5>
                            </td>
                            <td>
                                <h5 id="moyenneS1_copy">0</h5>
                            </td>
                            <td>
                                <h5 id="creditS1_copy">0</h5>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <h5>Semestre 2</h5>
                            </td>
                            <td>
                                <h5 id="moyenneS2_copy">0</h5>
                            </td>a
                            <td>
                                <h5 id="creditS2_copy">0</h5>
                            </td>
                        </tr>
                        <tr>
                        </tr>
                        <tr>
                            <td>
                                <h5>Année </h5>
                            </td>
                            <td>
                                <h5 id="moyenneGen">0</h5>
                            </td>
                            <td>
                                <h5 id="creditGen">0</h5>
                            </td>                            
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- js -->
    <script type='text/javascript' src='assets/js/jquery.js'></script>
    <script type='text/javascript' src='assets/js/popper.min.js'></script>
    <script type='text/javascript' src='assets/js/bootstrap.min.js'></script>
    <script type='text/javascript' src='assets/js/shards.min.js'></script>
    <script type='text/javascript' src='assets/js/main.js'></script>
    <script type='text/javascript' src='canevas/js/utils.js'></script>
    <script type='text/javascript' src='canevas/json/CPST1.json'></script>
	<script type='text/javascript' src='canevas/json/CPST2.json'></script>
    <script type='text/javascript' src='canevas/json/GE.json'></script>
    <script type='text/javascript' src='canevas/json/micro.json'></script>

    
    <script type='text/javascript'>
         var url_string =  window.location;
         //~ console.log(url_string);
            var url = new URL(url_string);
            var level = url.searchParams.get("level");
            //~ console.log(level);
            if(level!=null)
                $("#nav-titre").html(level+" Calculateur de Moyenne");
    </script>
    <script type='text/javascript' src='canevas/js/majq_Model.js'></script>
<script>
    (function() {
        var STORAGE_KEY = 'helo_calc_save_';

        // This function generates a unique ID for every input based on where it sits in the table
        // Example ID: "sem1_row3_col2"
        function identifyAndRestoreInputs() {
            var inputs = document.querySelectorAll('input, select');
            
            inputs.forEach(function(input) {
                // If input has no ID, make one based on its position
                if (!input.id) {
                    var row = input.closest('tr');
                    var table = input.closest('table');
                    if (row && table) {
                        var rowIndex = Array.from(table.rows).indexOf(row);
                        var tableId = table.id || 'unknown_table';
                        // We use the input's name or placeholder or type to distinguish multiple inputs in one row
                        var uniqueSuffix = input.name || input.placeholder || input.type; 
                        input.id = tableId + '_r' + rowIndex + '_' + uniqueSuffix.replace(/\s/g, '');
                    }
                }

                // Now that it has an ID, try to load its value
                if (input.id) {
                    var saved = localStorage.getItem(STORAGE_KEY + input.id);
                    if (saved !== null && saved !== "") {
                        input.value = saved;
                        // Force the calculator to recalculate with the new value
                        $(input).trigger('change');
                        $(input).trigger('keyup');
                    }
                }
            });
        }

        // 1. Listen for "input" events globally (Event Delegation)
        // This works even for inputs created later
        document.body.addEventListener('input', function(e) {
            var target = e.target;
            if (target.tagName === 'INPUT' || target.tagName === 'SELECT') {
                if (target.id) {
                    localStorage.setItem(STORAGE_KEY + target.id, target.value);
                }
            }
        });

        // 2. Watch for the calculator to appear (MutationObserver)
        // This detects when your other script adds the rows to the table
        var observer = new MutationObserver(function(mutations) {
            // Every time the page changes, try to find and restore inputs
            identifyAndRestoreInputs();
        });

        // Start watching the body for changes
        observer.observe(document.body, { childList: true, subtree: true });

    })();
</script>
</script>
</body>

</html>
